<!DOCTYPE html>
<html lang="en" class="login-page">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration - National Aviation Academy of the Philippines</title>
    <link rel="stylesheet" href="../assets/css/logincss/index.css">
</head>
<body class="login-page">
    <!-- Header Section -->
    <header class="header-section">
        <img src="../assets/photos/indexphotos/header.png" alt="Header" class="header-image">
    </header>

    <!-- Main Content Section -->
    <main class="main-content">
        <div class="login-container">
            <img src="../assets/photos/registration/registerStudent.png" alt="User Icon" class="login-icon" id="userIcon">
            
            <!-- Dropdown Container -->
            <div class="dropdown-container">
                <div class="dropdown-wrapper">
                    <button class="dropdown-button" id="userDropdown">
                        <span class="dropdown-text" id="dropdownText">Select User Type</span>
                        <span class="dropdown-arrow">▼</span>
                    </button>
                    <div class="dropdown-menu" id="dropdownMenu">
                        <div class="dropdown-item" data-value="Student">Student</div>
                        <div class="dropdown-item" data-value="Organization">Organization</div>
                        <div class="dropdown-item" data-value="OSA">OSA</div>
                    </div>
                </div>
            </div>

            <form class="login-form registration-form">
                <!-- Organization Selector Button (shown only for Organization) -->
                <div class="input-wrapper" id="organizationSelectorWrapper" style="display: none;">
                    <button type="button" class="organization-selector-button" id="organizationSelectorBtn">
                        <span id="organizationSelectorText">Select Organization</span>
                        <span class="dropdown-arrow">▼</span>
                    </button>
                </div>
                
                <div class="input-wrapper" id="studentNumberWrapper">
                    <input type="text" placeholder="Student Number" class="login-input" id="studentNumber" required>
                </div>
                <div class="input-wrapper" id="employeeNumberWrapper" style="display: none;">
                    <input type="text" placeholder="Employee Number" class="login-input" id="employeeNumber" required>
                </div>
                <div class="input-wrapper">
                    <input type="text" placeholder="Name" class="login-input" id="name" required>
                </div>
                <div class="input-wrapper" id="courseSectionWrapper">
                    <input type="text" placeholder="Course & Section" class="login-input" id="courseSection" required>
                </div>
                <div class="input-wrapper">
                    <input type="email" placeholder="Email" class="login-input" id="email" required>
                </div>
                <div class="input-wrapper password-wrapper">
                    <input type="password" placeholder="Password" class="login-input" id="password-input" required>
                    <span class="eye-icon" id="eye-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                    </span>
                </div>
                <div class="input-wrapper password-wrapper">
                    <input type="password" placeholder="Re-enter password" class="login-input" id="confirm-password-input" required>
                    <span class="eye-icon" id="eye-icon-confirm">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                    </span>
                </div>
                <button type="submit" class="login-button">REGISTER</button>
                <div class="login-links">
                    <span class="register-text">Already have an account? <a href="index.html" class="register-link">Go back!</a></span>
                </div>
            </form>
        </div>
    </main>

    <!-- Footer Section -->
    <footer class="footer-section">
        <img src="../assets/photos/indexphotos/footer.png" alt="Footer" class="footer-image">
    </footer>

    <!-- Organization Selection Modal -->
    <div class="modal-overlay" id="organizationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Select Organization</h2>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="organization-list">
                    <div class="organization-item" data-org="Supreme Student Council">Supreme Student Council</div>
                    <div class="organization-divider-label">ICS</div>
                    <div class="organization-item" data-org="AISERS">AISERS</div>
                    <div class="organization-item" data-org="ELITECH">ELITECH</div>
                    <div class="organization-divider-label">ILAS</div>
                    <div class="organization-item" data-org="ILASSO">ILASSO</div>
                    <div class="organization-divider-label">INET</div>
                    <div class="organization-item" data-org="AERO-ATSO">AERO-ATSO</div>
                    <div class="organization-item" data-org="AETSO">AETSO</div>
                    <div class="organization-item" data-org="AMTSO">AMTSO</div>
                    <div class="organization-divider-label">INTEREST CLUB</div>
                    <div class="organization-item" data-org="RCYC">RCYC</div>
                    <div class="organization-item" data-org="CYC">CYC</div>
                    <div class="organization-item" data-org="SCHOLAR'S GUILD">SCHOLAR'S GUILD</div>
                    <div class="organization-item" data-org="AERONAUTICA">AERONAUTICA</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dropdown functionality
        const dropdownButton = document.getElementById('userDropdown');
        const dropdownMenu = document.getElementById('dropdownMenu');
        const dropdownText = document.getElementById('dropdownText');
        const dropdownItems = document.querySelectorAll('.dropdown-item');
        
        // Check URL parameter for auto-selection
        const urlParams = new URLSearchParams(window.location.search);
        const userType = urlParams.get('type');
        
        // Add placeholder class initially (will be removed if auto-selecting)
        if (!userType) {
            dropdownButton.classList.add('placeholder');
        }

        // Toggle dropdown menu
        dropdownButton.addEventListener('click', function(e) {
            e.stopPropagation();
            dropdownMenu.classList.toggle('show');
            dropdownButton.classList.toggle('active');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!dropdownButton.contains(e.target) && !dropdownMenu.contains(e.target)) {
                dropdownMenu.classList.remove('show');
                dropdownButton.classList.remove('active');
            }
        });

        // Handle dropdown item selection
        const userIcon = document.getElementById('userIcon');
        const iconPaths = {
            'Student': '../assets/photos/registration/registerStudent.png',
            'Organization': '../assets/photos/registration/registerOrganization.png',
            'OSA': '../assets/photos/registration/registerOSA.png'
        };
        
        let selectedValue = null; // Track selected value

        // Form field references
        const studentNumberWrapper = document.getElementById('studentNumberWrapper');
        const courseSectionWrapper = document.getElementById('courseSectionWrapper');
        const organizationSelectorWrapper = document.getElementById('organizationSelectorWrapper');
        const employeeNumberWrapper = document.getElementById('employeeNumberWrapper');
        const studentNumberInput = document.getElementById('studentNumber');
        const courseSectionInput = document.getElementById('courseSection');
        const employeeNumberInput = document.getElementById('employeeNumber');
        const organizationSelectorText = document.getElementById('organizationSelectorText');
        const organizationSelectorBtn = document.getElementById('organizationSelectorBtn');

        // Function to handle user type selection
        function selectUserType(value) {
            selectedValue = value;
            dropdownText.textContent = value;
            dropdownMenu.classList.remove('show');
            dropdownButton.classList.remove('active');
            dropdownButton.classList.remove('placeholder'); // Remove placeholder styling
            
            // Update icon based on selection
            if (iconPaths[value]) {
                userIcon.src = iconPaths[value];
            }

            // Show/hide form fields based on selection
            if (value === 'Student') {
                studentNumberWrapper.style.display = 'flex';
                courseSectionWrapper.style.display = 'flex';
                employeeNumberWrapper.style.display = 'none';
                organizationSelectorWrapper.style.display = 'none';
                studentNumberInput.required = true;
                courseSectionInput.required = true;
                employeeNumberInput.required = false;
                // Reset organization selector
                organizationSelectorText.textContent = 'Select Organization';
                organizationSelectorBtn.classList.add('placeholder');
            } else if (value === 'Organization') {
                studentNumberWrapper.style.display = 'flex';
                courseSectionWrapper.style.display = 'flex';
                employeeNumberWrapper.style.display = 'none';
                organizationSelectorWrapper.style.display = 'flex';
                studentNumberInput.required = true;
                courseSectionInput.required = true;
                employeeNumberInput.required = false;
            } else if (value === 'OSA') {
                studentNumberWrapper.style.display = 'none';
                courseSectionWrapper.style.display = 'none';
                employeeNumberWrapper.style.display = 'flex';
                organizationSelectorWrapper.style.display = 'none';
                studentNumberInput.required = false;
                courseSectionInput.required = false;
                employeeNumberInput.required = true;
                // Reset organization selector
                organizationSelectorText.textContent = 'Select Organization';
                organizationSelectorBtn.classList.add('placeholder');
            }
        }

        // Auto-select user type from URL parameter
        if (userType && (userType === 'Student' || userType === 'Organization' || userType === 'OSA')) {
            selectUserType(userType);
        }

        // Handle dropdown item clicks
        dropdownItems.forEach(item => {
            item.addEventListener('click', function() {
                const value = this.getAttribute('data-value');
                selectUserType(value);
            });
        });

        // Organization Modal functionality
        const organizationModal = document.getElementById('organizationModal');
        const modalClose = document.getElementById('modalClose');
        const organizationItems = document.querySelectorAll('.organization-item');

        // Add placeholder class initially
        organizationSelectorBtn.classList.add('placeholder');

        // Open modal
        organizationSelectorBtn.addEventListener('click', function() {
            organizationModal.classList.add('show');
        });

        // Close modal
        modalClose.addEventListener('click', function() {
            organizationModal.classList.remove('show');
        });

        // Close modal when clicking outside
        organizationModal.addEventListener('click', function(e) {
            if (e.target === organizationModal) {
                organizationModal.classList.remove('show');
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && organizationModal.classList.contains('show')) {
                organizationModal.classList.remove('show');
            }
        });

        // Handle organization selection
        organizationItems.forEach(item => {
            item.addEventListener('click', function() {
                const orgName = this.getAttribute('data-org');
                organizationSelectorText.textContent = orgName;
                organizationModal.classList.remove('show');
                organizationSelectorBtn.classList.remove('placeholder');
            });
        });

        // Toggle password visibility for first password field
        const eyeIcon = document.getElementById('eye-icon');
        const passwordInput = document.getElementById('password-input');
        
        const eyeOpenSVG = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>';
        const eyeClosedSVG = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>';
        
        eyeIcon.addEventListener('click', function() {
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                eyeIcon.innerHTML = eyeClosedSVG;
            } else {
                passwordInput.type = 'password';
                eyeIcon.innerHTML = eyeOpenSVG;
            }
        });

        // Toggle password visibility for confirm password field
        const eyeIconConfirm = document.getElementById('eye-icon-confirm');
        const confirmPasswordInput = document.getElementById('confirm-password-input');
        
        eyeIconConfirm.addEventListener('click', function() {
            if (confirmPasswordInput.type === 'password') {
                confirmPasswordInput.type = 'text';
                eyeIconConfirm.innerHTML = eyeClosedSVG;
            } else {
                confirmPasswordInput.type = 'password';
                eyeIconConfirm.innerHTML = eyeOpenSVG;
            }
        });
    </script>
</body>
</html>
