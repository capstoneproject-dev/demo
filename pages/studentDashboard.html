<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Organization Dashboard</title>

    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- STYLESHEET REFERENCE -->
    <link rel="stylesheet" href="../assets/css/studentDashboard.css">
</head>

<body>

    <!-- Sidebar Navigation -->
    <aside class="sidebar">
        <div class="logo-area">
            <i class="fa-solid fa-graduation-cap logo-icon"></i>
            <span class="logo-text">StudentHub</span>
        </div>

        <ul class="nav-menu">
            <li class="nav-item">
                <a href="#" class="nav-link active" onclick="navigate('dashboard', this)">
                    <i class="fa-solid fa-table-columns nav-icon"></i>
                    <span class="nav-label">Dashboard</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" onclick="navigate('organizations', this)">
                    <i class="fa-solid fa-people-group nav-icon"></i>
                    <span class="nav-label">Organizations</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" onclick="navigate('services', this)">
                    <i class="fa-solid fa-basket-shopping nav-icon"></i>
                    <span class="nav-label">Services</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" onclick="navigate('profile', this)">
                    <i class="fa-regular fa-id-card nav-icon"></i>
                    <span class="nav-label">Profile</span>
                </a>
            </li>
        </ul>

        <div class="sidebar-footer">
            <button class="theme-toggle" id="themeBtn">
                <i class="fa-solid fa-moon nav-icon"></i>
                <span class="nav-label">Dark Mode</span>
            </button>
            <div class="nav-item">
                <a href="#" class="logout-btn" onclick="handleLogout(event)">
                    <i class="fa-solid fa-arrow-right-from-bracket nav-icon"></i>
                    <span class="nav-label">Logout</span>
                </a>
            </div>
        </div>
    </aside>

    <!-- Main Content Area -->
    <main class="main-content">

        <!-- Top Header -->
        <header>
            <div class="header-title">
                <h1 id="page-title">Dashboard</h1>
                <p id="current-date">Fetching date...</p>
            </div>

            <div class="header-controls">
                <!-- Mobile Theme Toggle -->
                <button class="icon-btn mobile-only" onclick="toggleThemeMobile()">
                    <i class="fa-solid fa-moon" id="mobile-theme-icon"></i>
                </button>

                <!-- Mobile Logout -->
                <a href="#" class="icon-btn mobile-only logout-icon" onclick="handleLogout(event)">
                    <i class="fa-solid fa-arrow-right-from-bracket"></i>
                </a>

                <!-- User Profile -->
                <div class="user-profile" onclick="navigate('profile')">
                    <div class="user-profile-box">
                        <img src="https://picsum.photos/seed/student1/100/100" alt="Student" class="avatar">
                        <div class="user-info">
                            <span>Juan Dela Cruz</span>
                            <small>BSCS - Year 3</small>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- DASHBOARD VIEW -->
        <div id="dashboard" class="section-view active">


            <div class="content-row">
                <!-- Recent Announcements -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Latest Announcements</div>
                        <a href="#" style="color:var(--primary); text-decoration:none; font-size:0.85rem;"
                            onclick="navigate('organizations')">View All</a>
                    </div>
                    <div id="announcements-list">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Quick Activity -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Recent Activity</div>
                    </div>
                    <div class="list-item">
                        <div class="item-icon"><i class="fa-solid fa-print"></i></div>
                        <div class="item-content">
                            <h4>Printing Service</h4>
                            <p>Availed 5 pages</p>
                        </div>
                        <span class="date-badge">2h ago</span>
                    </div>
                    <div class="list-item">
                        <div class="item-icon"><i class="fa-solid fa-user-plus"></i></div>
                        <div class="item-content">
                            <h4>Membership</h4>
                            <p>Applied to ELITECH</p>
                        </div>
                        <span class="date-badge">1d ago</span>
                    </div>
                </div>
            </div>

            <!-- Upcoming Events Preview -->
            <div class="content-row">
                <!-- Existing Events List Card -->
                <div class="card" style="flex: 2;">
                    <div class="card-header">
                        <div class="card-title">Upcoming Events</div>
                        <a href="#" style="color:var(--primary); text-decoration:none; font-size:0.85rem;"
                            onclick="navigate('organizations')">View All</a>
                    </div>
                    <div class="content-row" style="margin-bottom: 0; gap: 20px;">
                        <!-- Populated by JS -->
                        <div id="events-preview-container" style="display: contents;"></div>
                    </div>
                </div>

                <!-- New Functional Calendar Card -->
                <div class="card" id="event-calendar">
                    <div class="card-header">
                        <div class="card-title">Event Calendar</div>
                        <div class="calendar-nav">
                            <button class="calendar-nav-btn" onclick="changeMonth(-1)"><i
                                    class="fa-solid fa-chevron-left"></i></button>
                            <span id="calendarMonthYear"></span>
                            <button class="calendar-nav-btn" onclick="changeMonth(1)"><i
                                    class="fa-solid fa-chevron-right"></i></button>
                        </div>
                    </div>
                    <div class="calendar-grid">
                        <div class="calendar-day-header">Sun</div>
                        <div class="calendar-day-header">Mon</div>
                        <div class="calendar-day-header">Tue</div>
                        <div class="calendar-day-header">Wed</div>
                        <div class="calendar-day-header">Thu</div>
                        <div class="calendar-day-header">Fri</div>
                        <div class="calendar-day-header">Sat</div>
                    </div>
                    <div id="calendarDays" class="calendar-grid">
                        <!-- Days populated by JS -->
                    </div>
                </div>
            </div>
        </div>

        <!-- ORGANIZATIONS VIEW -->
        <div id="organizations" class="section-view">
            <div class="tabs">
                <button class="tab-btn active" onclick="switchOrgTab('about', this)">About</button>
                <button class="tab-btn" onclick="switchOrgTab('my-organization', this)">My Organization</button>
                <button class="tab-btn" onclick="switchOrgTab('membership', this)">Membership</button>
                <button class="tab-btn" onclick="switchOrgTab('events', this)">Events</button>
                <button class="tab-btn" onclick="switchOrgTab('contacts', this)">Contacts</button>
            </div>

            <div id="tab-content" class="card">
                <!-- Content injected via JS -->
            </div>
        </div>

        <!-- SERVICES VIEW -->
        <div id="services" class="section-view">
            <div class="services-search">
                <i class="fa-solid fa-magnifying-glass"></i>
                <input type="text" id="serviceSearch"
                    placeholder="Search for a service (e.g., Printing, Calculator, Locker)..."
                    onkeyup="filterServices()">
            </div>

            <!-- PRINTING HERO SECTION -->
            <div class="printing-hero" id="printingHero">
                <div class="hero-content">
                    <!-- Left Side: Info -->
                    <div class="hero-info">
                        <div class="hero-icon-wrapper">
                            <i class="fa-solid fa-print"></i>
                        </div>
                        <div class="hero-text">
                            <h2>Printing Services</h2>
                            <p>Upload your documents and get them printed quickly on campus.</p>
                            <ul class="supported-services-list">
                                <li><i class="fa-solid fa-circle-check"></i> Document Printing</li>
                                <li><i class="fa-solid fa-circle-check"></i> 1×1 Photo Processing</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Right Side: Upload UI -->
                    <div class="hero-upload">
                        <div class="upload-zone" id="uploadZone">
                            <input type="file" id="fileInput" hidden accept=".pdf,.docx,.png,.jpg,.jpeg">
                            <div class="upload-content">
                                <div class="upload-icon">
                                    <i class="fa-solid fa-cloud-arrow-up"></i>
                                </div>
                                <p class="upload-main-text">Drag & drop files here</p>
                                <p class="upload-sub-text">or <span class="browse-link">browse files</span></p>
                                <p class="upload-formats">Supported: PDF, DOCX, PNG, JPG</p>
                            </div>
                            <!-- Success / File Selected State -->
                            <div class="file-selected-state" id="fileSelectedState" style="display: none;">
                                <div class="selected-file-icon">
                                    <i class="fa-solid fa-file-lines"></i>
                                </div>
                                <div class="selected-file-info">
                                    <p class="filename-text" id="filenameText">document.pdf</p>
                                    <p class="file-size-text">Ready to print</p>
                                </div>
                                <button class="btn-upload-submit" id="btnUploadSubmit" disabled>Upload to Print</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CATEGORIZED SERVICES LIST (Previously servicesGrid) -->
            <h2 class="section-title">Rent an Item</h2>
            <div id="servicesGrid">
                <!-- Categories will be injected here via JavaScript -->
            </div>
        </div>

        <!-- PROFILE VIEW -->
        <div id="profile" class="section-view">
            <div class="card" style="margin-bottom: 24px;">
                <div style="display: flex; align-items: center; gap: 20px; flex-wrap: wrap;">
                    <img src="https://picsum.photos/seed/student1/150/150" alt="Profile"
                        style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover; border: 4px solid var(--primary);">
                    <div>
                        <h2 style="margin-bottom: 5px;">Juan Dela Cruz</h2>
                        <p style="color: var(--muted);">Student ID: 2021-12345</p>
                        <p style="color: var(--muted);">Course: BS Computer Science</p>
                        <div style="margin-top: 10px; display: flex; gap: 10px;">
                            <button
                                style="padding: 8px 16px; border-radius: var(--radius-sm); border: 1px solid var(--border); background: var(--panel); color: var(--text); cursor: pointer;">Edit
                                Profile</button>
                            <button
                                style="padding: 8px 16px; border-radius: var(--radius-sm); border: 1px solid var(--border); background: var(--panel); color: var(--text); cursor: pointer;">Change
                                Password</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">Overall Transaction History</div>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Service/Item</th>
                                <th>Organization</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="transaction-table">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </main>

    <!-- EVENT REGISTRATION MODAL -->
    <div id="eventRegistrationModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Event Registration</h3>
                <button class="close-modal" onclick="closeRegistrationModal()"><i
                        class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="modal-body">
                <p id="modalEventTitle" style="margin-bottom: 20px; color: var(--primary); font-weight: 600;"></p>
                <form id="registrationForm" onsubmit="handleRegistrationSubmit(event)">
                    <div class="form-group">
                        <label>Full Name</label>
                        <input type="text" placeholder="e.g. Juan Dela Cruz" required>
                    </div>
                    <div class="form-group">
                        <label>Student ID</label>
                        <input type="text" placeholder="e.g. 2021-12345" required>
                    </div>
                    <div class="form-group">
                        <label>Email Address</label>
                        <input type="email" placeholder="e.g. juan@student.edu" required>
                    </div>
                    <div class="form-group">
                        <label>Contact Number</label>
                        <input type="tel" placeholder="e.g. 09123456789" required>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn-cancel" onclick="closeRegistrationModal()">Cancel</button>
                        <button type="submit" class="btn-submit">Pre-Register</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- EVENT DETAILS MODAL -->
    <div id="eventDetailsModal" class="modal-overlay">
        <div class="modal-content details-modal-content">
            <div class="modal-header">
                <h3 id="detailsEventTitle">Event Details</h3>
                <button class="close-modal" onclick="closeDetailsModal()"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="modal-body">

                <!-- Modern Carousel -->
                <div class="carousel-container">
                    <div class="carousel-track" id="carouselTrack">
                        <!-- Slides injected via JS -->
                    </div>

                    <!-- Navigation Arrows -->
                    <button class="carousel-arrow carousel-prev" onclick="moveSlide(-1)">
                        <i class="fa-solid fa-chevron-left"></i>
                    </button>
                    <button class="carousel-arrow carousel-next" onclick="moveSlide(1)">
                        <i class="fa-solid fa-chevron-right"></i>
                    </button>

                    <!-- Indicators -->
                    <div class="carousel-indicators" id="carouselIndicators">
                        <!-- Dots injected via JS -->
                    </div>
                </div>

                <!-- Info Grid -->
                <div class="details-info-grid">
                    <div class="info-item">
                        <i class="fa-regular fa-calendar info-icon"></i>
                        <div>
                            <small>Date</small>
                            <span id="detailsDate"></span>
                        </div>
                    </div>
                    <div class="info-item">
                        <i class="fa-regular fa-clock info-icon"></i>
                        <div>
                            <small>Time</small>
                            <span id="detailsTime"></span>
                        </div>
                    </div>
                    <div class="info-item">
                        <i class="fa-solid fa-location-dot info-icon"></i>
                        <div>
                            <small>Venue</small>
                            <span id="detailsVenue"></span>
                        </div>
                    </div>
                    <div class="info-item">
                        <i class="fa-solid fa-users info-icon"></i>
                        <div>
                            <small>Participants</small>
                            <span id="detailsParticipants"></span>
                        </div>
                    </div>
                </div>

                <!-- Description -->
                <div class="details-description">
                    <h4>About this Event</h4>
                    <p id="detailsDesc"></p>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn-submit" onclick="closeDetailsModal()">Close Details</button>
                </div>
            </div>
        </div>
    </div>

    <!-- SERVICE SELECTION MODAL -->
    <div id="serviceSelectModal" class="modal-overlay" aria-hidden="true" role="dialog" aria-modal="true">
        <div class="modal-content service-select-modal">
            <div class="modal-header">
                <div class="header-text-group">
                    <h3 id="modalTitle">Select an Organization</h3>
                    <p id="modalSubtitle">Choose who will provide: ...</p>
                </div>
                <button class="close-modal" aria-label="Close modal" onclick="closeServiceModal()">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>

            <div class="modal-body">

                <!-- STEP 1: ORG SELECTION -->
                <div id="step1-org-selection">
                    <div id="orgSelectList" class="org-select-list">
                        <!-- Organization options injected via JS -->
                    </div>
                </div>

                <!-- STEP 2: RENTAL DETAILS -->
                <div id="step2-rental-details" style="display: none;">

                    <div class="form-group">
                        <label for="rentalDate">Date of Rental</label>
                        <input type="date" id="rentalDate">
                        <small style="color: var(--muted); font-size: 0.75rem;">Today or tomorrow only</small>
                    </div>

                    <div class="time-inputs-row">
                        <div class="form-group">
                            <label for="startTime">Start Time</label>
                            <input type="time" id="startTime" step="1800">
                        </div>
                        <div class="form-group">
                            <label for="duration">Duration (Hours)</label>
                            <input type="number" id="duration" step="0.5" min="0.5" placeholder="e.g. 1.5">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>End Time</label>
                        <div class="read-only-field">
                            <span id="endTimeDisplay">--:-- --</span>
                            <i class="fa-solid fa-lock lock-icon"></i>
                        </div>
                    </div>

                    <!-- Validation Error Message -->
                    <div id="rentalErrorMessage" class="error-message"></div>

                    <!-- Price Display -->
                    <div class="price-summary">
                        Total Amount: <span id="totalAmountDisplay">₱0.00</span>
                    </div>
                </div>

                <div class="modal-footer">
                    <!-- Buttons will be swapped dynamically by JS -->
                    <button type="button" class="btn-cancel" id="btnStep1Cancel"
                        onclick="closeServiceModal()">Cancel</button>
                    <button type="button" class="btn-cancel" id="btnStep2Back" style="display: none;"
                        onclick="handleBackToStep1()">Back</button>
                    <button type="button" class="btn-submit" id="btnStep1Continue" disabled>Continue</button>
                    <button type="button" class="btn-submit" id="btnStep2Confirm" style="display: none;"
                        disabled>Confirm
                        Rental</button>
                </div>
            </div>
        </div>
    </div>

    <!-- TOAST NOTIFICATION -->
    <div id="toast" class="toast-notification">
        <div class="toast-content">
            <i class="fa-solid fa-circle-check toast-icon"></i>
            <span id="toastMessage">Action successful</span>
        </div>
    </div>

    <!-- JAVASCRIPT REFERENCE -->
    <script src="../assets/js/studentDashboard.js"></script>
</body>

</html>